<!DOCTYPE html>
<meta charset="utf-8">
<style>

rect {
  fill: rgb(200,20,20);
}

circle {
  fill: rgb(31, 119, 180);
  fill-opacity: .25;
  stroke: rgb(31, 119, 180);
  stroke-width: 1px;
}

.leaf circle {
  fill: #ff7f0e;
  fill-opacity: 1;
}

text {
  font: 10px sans-serif;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}
.y.axis text {
        font-family: sans-serif;
        font-size: 20px;
        font-weight: bolder;
        fill: rgb(100,100,100);
      }

.x.axis path {
  display: none;
}

</style>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script>

var margin = {top: 20, right: 20, bottom: 30, left: 40},
    width = 960 - margin.left - margin.right,
    height = 200 - margin.top - margin.bottom,
    trans_y = 100;

var tickFormat = "%H:%M";


// d3.csv("sample_data", funtion(data){
// return {
//   zeit: new Date(+d.zeit,0,1),
//   art: d.Art
// };
// }, function(error, rows) {
//   console.log(rows);
// });

// var data = [
//   {"zeit": new Date("March 6, 2013 09:30"), "art": "Frühstück"},
//   {"zeit": new Date("March 6, 2013 11:13"), "art": "Mittagessen"},
//   {"zeit": new Date("March 6, 2013 12:45"), "art": "Snack"},
//   {"zeit": new Date("March 6, 2013 12:45"), "art": "Abenbrot"}
//   ];

var data = [
  {"name": "Huong", "zeit": new Date("March 7, 2013 08:15"), "art": "Frühstück"},
  {"name": "Huong", "zeit": new Date("March 7, 2013 12:30"), "art": "Mittagessen"},
  {"name": "Huong", "zeit": new Date("March 7, 2013 16:30"), "art": "Snack"},
  {"name": "Huong", "zeit": new Date("March 7, 2013 20:00"), "art": "Abenbrot"},
  {"name": "Martin", "zeit": new Date("March 7, 2013 09:30"), "art": "Frühstück"},
  {"name": "Martin", "zeit": new Date("March 7, 2013 12:45"), "art": "Mittagessen"},
  {"name": "Martin", "zeit": new Date("March 7, 2013 13:15"), "art": "Snack"},
  {"name": "Martin", "zeit": new Date("March 7, 2013 18:30"), "art": "Abenbrot"},
  {"name": "Tom", "zeit": new Date("March 7, 2013 09:00"), "art": "Frühstück"},
  {"name": "Tom", "zeit": new Date("March 7, 2013 12:30"), "art": "Mittagessen"},
  {"name": "Tom", "zeit": new Date("March 7, 2013 15:30"), "art": "Snack"},
  {"name": "Tom", "zeit": new Date("March 7, 2013 21:00"), "art": "Abenbrot"},
  {"name": "Thomas", "zeit": new Date("March 7, 2013 10:15"), "art": "Frühstück"},
  {"name": "Thomas", "zeit": new Date("March 7, 2013 14:30"), "art": "Mittagessen"},
  {"name": "Thomas", "zeit": new Date("March 7, 2013 22:30"), "art": "Snack"},
  {"name": "Thomas", "zeit": new Date("March 7, 2013 19:00"), "art": "Abenbrot"}
  ];

var x = d3.time.scale().domain([new Date("March 7, 2013 07:00"),new Date("March 7, 2013 23:59")]).range([0, width]);
var y = d3.scale.ordinal().domain(["Huong","Martin","Tom","Thomas"]).rangeRoundBands([0, height], .1);

var xAxis = d3.svg.axis().scale(x).orient("bottom").tickFormat(d3.time.format(tickFormat)).tickSubdivide(1)
    .tickSize(6,3,0).tickPadding(10).ticks(d3.time.minutes, 60);
var yAxis = d3.svg.axis()
    .scale(y).orient("left").tickSize(0).tickPadding(10);

var svg = d3.select("body").append("svg")
    .attr("width", 1200)
    .attr("height", 480)
  .append("g")
    .attr("transform", "translate(2,2)");

svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate("+ trans_y +"," + height + ")")
      .call(xAxis);

svg.append("g")
      .attr("class", "y axis")
      .attr("transform", "translate("+ trans_y +",0)")
      .call(yAxis);

// svg.append("rect")
//     .attr("x", function(d) {
//       return x(new Date("March 7, 2013 08:00"));
//     })
//     .attr("y", function(d) {
//       return y("Huong");
//     })
//     .attr("width", width)
//     .attr("height", 50)
//     .attr("style", "fill: rgb(200,200,200)");

// svg.append("rect")
//     .attr("x", function(d) {
//       return x(new Date("March 7, 2013 08:00"));
//     })
//     .attr("y", function(d) {
//       return y("Martin");
//     })
//     .attr("width", width)
//     .attr("height", 50)
//     .attr("style", "fill: rgb(200,200,200)");

// svg.append("rect")
//     .attr("x", function(d) {
//       return x(new Date("March 7, 2013 08:00"));
//     })
//     .attr("y", function(d) {
//       return y("Tom");
//     })
//     .attr("width", width)
//     .attr("height", 50)
//     .attr("style", "fill: rgb(200,200,200)");

var rect = svg.selectAll("rect")
    .data(data);
var enter = rect.enter().append("rect");

enter.attr("x", function(d) {
  return x(d.zeit);
});

enter.attr("transform", "translate("+ trans_y +",0)");

enter.attr("y", function(d) {
  return y(d.name);
});

// enter.attr("y", function(d) {
//   return (d.name * 60) - 50;
// });

enter.attr("rx", 5).attr("ry", 5);
enter.attr("width", 25); 
enter.attr("height", 30);

enter.attr("style", function(d) {
      if(d.art == "Frühstück") {
        return "fill: rgb(200,20,20)";
      }
      if(d.art == "Mittagessen") {
        return "fill: rgb(140,190,50)";
      }
      if(d.art == "Abenbrot") {
        return "fill: rgb(90,180,220)";
      }
      if(d.art == "Snack") {
        return "fill: rgb(255,200,60)";
      }
    })
</script>